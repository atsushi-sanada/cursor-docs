# Cursor プロジェクト初期セットアップ自動化ワークフロー

このワークフローは、Cursorプロジェクトの基本構造を作成し、AGENTS.mdと.cursor/rules/を順次セットアップします。

## 📋 クイックリファレンス

### 実行フロー（3ステップ）
1. **ステップ1**: プロジェクト構造作成 → 完了確認 → ユーザー承認待ち
2. **ステップ2**: テンプレート確認（必須・5セクションのみ） → Project Visionヒアリング → テンプレート構造再確認（手順3） → AGENTS.md生成（思想のみ・5セクションのみ） → テンプレート準拠検証（手順7） → 完了確認（手順11） → ユーザー承認待ち
3. **ステップ3**: ルールファイル提案 → ユーザー承認 → ファイル作成

### ⚠️ 重要な禁止事項（必ず守る）
- ❌ **テンプレート確認をスキップしてヒアリングに進む**（ステップ2の最初に必ず実行）
- ❌ **テンプレート構造を無視してセクションを追加する**（Agent Roles、Agent Interaction Rules、Development Workflow、Quality Standardsなどのセクションは追加しない）
- ❌ **テンプレート準拠検証をスキップする**（手順7を必ず実行）
- ❌ **完了確認をスキップして次のステップに進む**（手順11を必ず実行）
- ❌ **ユーザーの確認なしにファイルを作成する**
- ❌ **AGENTS.mdに具体的なルールを記載する**（思想・価値観のみ）
  - 命名規則、ツール名、設定値、ファイル名、実装方法などの具体的なルールは記載しない
- ❌ **テンプレート形式に従わずにAGENTS.mdを作成する**（5セクション必須、形式厳守、セクション名変更禁止）

### 各ステップの重要ポイント
- **ステップ1**: フォルダ構造のみ作成、AGENTS.mdは空ファイル
- **ステップ2**: テンプレート確認必須（最初に実行・5セクションのみ） → Project Visionのみヒアリング → テンプレート構造再確認（手順3） → 思想のみ生成（5セクションのみ） → テンプレート準拠検証必須（手順7・構造確認含む） → 完了確認必須（手順11）
- **ステップ3**: サマリ提案必須、ユーザー承認後に作成

### AGENTS.mdとrulesの書き分け
- **AGENTS.md**: 「なぜ」という思想・価値観のみ（50行以内）
- **rules**: 「どう」という具体的な手順・形式

---

## ⚠️ 重要な注意事項

**このワークフローは段階的に実行し、各ステップの完了時に必ずユーザーの確認を求めてください。**
- ユーザーの確認なしに次のステップに進まない
- ステップ2: テンプレート確認必須（最初に実行） → Project Visionのヒアリング必須 → テンプレート準拠検証必須
- ステップ3: サマリ提案必須、ユーザー承認後に作成

## ワークフロー概要

3ステップを順次実行し、各ステップの完了時にユーザーの確認を求める：

1. **プロジェクト構造の作成** - フォルダ構造とAGENTS.md（空ファイル）を作成
2. **AGENTS.mdの作成** - テンプレート確認（必須） → Project Visionヒアリング → 思想のみを生成 → テンプレート準拠検証（必須） → 完了確認
3. **.cursor/rules/の作成** - ルールファイル提案 → ユーザー承認 → ファイル作成

---

## ステップ1: プロジェクト構造の作成

以下のフォルダ構造を作成します：

```
project-root/
├ .cursor/
│   └ rules/
├ docs/
└ AGENTS.md
```

### 実行手順

1. `.cursor/rules/` ディレクトリが存在しない場合は作成する
2. `docs/` ディレクトリが存在しない場合は作成する
3. `AGENTS.md` が存在しない場合は空のファイルを作成する（既存の場合は上書きしない）

### 実行指示

このステップを実行する際は、以下のコマンドを実行してください：

```bash
# ディレクトリの作成
mkdir -p .cursor/rules
mkdir -p docs/team docs/policies docs/ai-generated

# AGENTS.mdが存在しない場合のみ作成
if [ ! -f AGENTS.md ]; then
  touch AGENTS.md
fi
```

または、ファイル操作ツールを使用して構造を作成してください。

### 完了確認

構造作成が完了したら、**必ず以下のメッセージを表示し、ユーザーの確認を待ってください**：

```
✅ ステップ1: プロジェクト構造の作成が完了しました。

作成された構造:
- .cursor/rules/
- docs/ (team/, policies/, ai-generated/)
- AGENTS.md

次のステップ（AGENTS.mdの作成）に進みますか？
- yes: ステップ2を開始します
- no: ここで終了します
```

**重要**: ユーザーが「yes」と回答するまで、次のステップに進まないでください。

---

## ステップ2: AGENTS.mdの作成

### テンプレート確認手順（必須・最初に実行）

**⚠️ 重要: このステップでは、必ず最初にテンプレートを確認・表示してから、ヒアリングと生成に進んでください。**

1. **ステップ開始の明示**
   - 「ステップ2: AGENTS.mdの作成を開始します。まず、AGENTS.mdのテンプレート形式を確認します。」と明示

2. **テンプレートの確認と表示（必須）**
   - **必ず以下のテンプレート構造を確認・表示してください**
   - **使用するセクション名を明示**: 以下の5つのセクション名のみを使用する
     - `# Project Vision`
     - `# Core Principles`
     - `# Architecture Philosophy`
     - `# Documentation Policy`
     - `# Development Mindset`
   - **禁止するセクション名を明示**: 以下のようなセクション名は使用しない
     - ❌ `# Agent Roles`
     - ❌ `# Agent Interaction Rules`
     - ❌ `# Development Workflow`
     - ❌ `# Quality Standards`
     - ❌ `# Technical Stack`
     - ❌ `# Constraints`
     - ❌ その他、テンプレートに定義されていないセクション名
   - テンプレートの各セクションの形式（見出し、箇条書き、記述内容の種類）を確認
   - 「このテンプレート形式に厳密に従ってAGENTS.mdを作成します。上記5セクションのみを使用し、テンプレートにないセクションは追加しません。」と確認メッセージを表示

3. **テンプレート参照の重要性を強調**
   - 「テンプレート形式に厳密に従うことが必須です。テンプレートにないセクションを追加したり、形式を変更したりしないでください。」
   - 「プロジェクトの要件に応じてセクションを追加することは禁止です。テンプレートの5セクションのみを使用してください。」
   - 「セクション名を変更することも禁止です。テンプレートで定義された正確なセクション名を使用してください。」

### ヒアリング項目

**Project Vision（プロジェクトのビジョン）のみ**をヒアリングします。**必ずAGENTS.mdのテンプレート（下記の「AGENTS.mdテンプレート」セクション）を参照してください。**

#### Project Vision（プロジェクトのビジョン）
- **質問**: 「このプロジェクトが目指すゴールを1〜3行で教えてください。」
- **目的**: プロジェクトの最終的な目標を明確にする

### ヒアリング手順

**⚠️ 重要: このステップでは必ずユーザーに質問し、回答を待ってから次のステップに進んでください。**

1. **テンプレート確認完了後の明示**
   - 「テンプレート確認が完了しました。次に、Project Visionについて質問します。」と明示

2. **Project Visionの質問を表示**
   - 「このプロジェクトが目指すゴールを1〜3行で教えてください。」と質問
   - **必ずユーザーの回答を待ってください**（自動で進めない）

3. **回答内容を確認**
   - 回答が不明確な場合は、具体例を提示して補足質問
   - 回答が得られたら次のステップ（AIによる自動生成）へ

### AIによる自動生成手順

**⚠️ 重要: 手順10でAGENTS.mdを保存した後、必ず手順11の完了確認メッセージを表示し、ユーザーの確認を待ってから次のステップに進んでください。完了確認をスキップしてステップ3に進むことは禁止です。**

Project Visionの回答を得たら、以下の手順でAIが2～5のセクションを自動生成します：

1. **@rulesを参照（思想の抽出のみ）**
   - **必ず@rulesを参照してください**
   - **⚠️ 重要: @rulesに記載されている具体的なルールは参照しない**
     - ❌ 参照しない具体例: 命名規則（camelCase、PascalCase、snake_caseなど）
     - ❌ 参照しない具体例: フォルダ構造（`src/features/**`、`modules/`など）
     - ❌ 参照しない具体例: コードテンプレート・コード例
     - ❌ 参照しない具体例: ツール名・ライブラリ名（black、isort、WebDriverWaitなど）
     - ❌ 参照しない具体例: 設定値・数値（10-20秒、UTF-8など）
     - ❌ 参照しない具体例: ファイル名（`config.bat`、`stamp.py`など）
     - ❌ 参照しない具体例: 実装方法・手順（「ID > CSS Selector > XPathの優先順位」など）
   - **✅ 参照すべき内容: ルールの「背後にある思想・価値観」のみ**
     - 例：「PascalCaseを使う」というルール → 「一貫性と可読性を重視する」という思想を抽出
     - 例：「src/features/**に機能を配置する」というルール → 「機能の独立性を重視する」という思想を抽出
     - 例：「WebDriverWaitを使用した明示的な待機処理」というルール → 「適切な待機処理により、ブラウザ自動化の安定性を確保する」という思想を抽出
     - 例：「認証情報は`config.bat`に保存」というルール → 「認証情報の安全な管理を最優先する」という思想を抽出

2. **Project Visionを分析**
   - ユーザーが提供したProject Visionの内容を分析
   - プロジェクトの性質を推測：
     - **コーディングプロジェクト**: ゲーム開発、Web開発、Unity、Python、JavaScript、C#、GASなど
     - **文書作成プロジェクト**: 技術文書、ブログ、マニュアル、翻訳、多言語対応など
     - **その他**: デザイン、データ分析、研究など

3. **テンプレート構造の再確認（必須・生成前に実行）**
   - **⚠️ 重要: セクション生成前に、必ずテンプレート構造を再確認してください**
   - **使用するセクション名を明示**: 以下の5つのセクション名のみを使用する
     - `# Project Vision`
     - `# Core Principles`
     - `# Architecture Philosophy`
     - `# Documentation Policy`
     - `# Development Mindset`
   - **禁止事項を明示**: テンプレートにないセクション名（例：Agent Roles、Agent Interaction Rules、Development Workflow、Quality Standardsなど）は使用しない
   - 「テンプレート構造を確認しました。上記5セクションのみを使用して生成します。」と確認メッセージを表示

4. **2～5のセクションを自動生成（思想のみ）**
   - **⚠️ 重要: 必ず手順3で確認したテンプレート構造に従って生成してください**
   - **Core Principles**: Project Visionから導かれる優先順位、ユーザー体験の基本方針、設計上の思想を生成
   - **Architecture Philosophy**: Project Visionから導かれる「なぜその構造が重要なのか」という価値観を生成（具体的な構造は記載しない）
   - **Documentation Policy**: Project Visionから導かれる「なぜ一貫性が重要なのか」という思想を生成（具体的な記法は記載しない）
   - **Development Mindset**: Project Visionから導かれる「なぜその開発方針が重要なのか」という価値観を生成（具体的な命名規則は記載しない）
   - **テンプレート以外のセクションを追加しない**: Agent Roles、Agent Interaction Rules、Development Workflow、Quality Standardsなどのセクションは追加しない

5. **生成方針（重要: 思想のみ、簡潔さを重視、テンプレート構造厳守）**
   - **⚠️ 最重要: テンプレート構造を厳格に遵守する**
     - **使用するセクション名は5つのみ**: `# Project Vision`、`# Core Principles`、`# Architecture Philosophy`、`# Documentation Policy`、`# Development Mindset`
     - **テンプレートにないセクションは追加しない**: Agent Roles、Agent Interaction Rules、Development Workflow、Quality Standards、Agent Roles、Technical Stack、Constraintsなどのセクションは一切追加しない
     - **セクション名の変更は禁止**: テンプレートで定義されたセクション名を変更したり、別名で呼んだりしない
   - **⚠️ 最重要: 具体的なルールを記載しない（思想・価値観のみ）**
     - **AGENTS.mdに書くべき内容の判断基準**:
       - 「なぜそうするのか」という思想・価値観 → AGENTS.mdに記載
       - 「どうするのか」という具体的な手順・形式 → rules（.cursor/rules/*.mdc）に記載
     - **❌ AGENTS.mdに書くべきでない具体例**:
       - 「変数名はcamelCaseを使う」
       - 「PEP8準拠（black/isort推奨）」
       - 「型ヒントの使用（関数の引数・戻り値）」
       - 「docstringの記述（Googleスタイル推奨）」
       - 「WebDriverWaitを使用した明示的な待機処理」
       - 「要素検出はID > CSS Selector > XPathの優先順位」
       - 「UTF-8エンコーディング（`chcp 65001`）」
       - 「認証情報は`config.bat`に保存（.gitignoreに追加）」
       - 「モジュール分割（stamp.py, worklog.pyなど機能別）」
       - 「タイムアウト値は適切に設定（10-20秒）」
       - その他、具体的な実装方法、ツール名、設定値、ファイル名、フォルダ構造など
     - **✅ AGENTS.mdに書くべき思想例**:
       - 「コードの可読性を最優先し、一貫性を重視する」
       - 「コードスタイルの一貫性を保つことで、チーム全体の生産性を向上させる」
       - 「適切な待機処理により、ブラウザ自動化の安定性を確保する」
       - 「認証情報の安全な管理を最優先する」
       - 「機能の独立性を重視し、モジュール分割を推奨する」
       - 「エラーハンドリングを適切に実装し、安定性を確保する」
   - **テンプレート項目を必ず含める**: 以下の5つのセクションを必ず含めてください
     - Project Vision（ユーザーの回答）
     - Core Principles（優先順位、ユーザー体験の基本方針、設計上の思想）
     - Architecture Philosophy（ディレクトリ構成の思想、責務分離の方針、データ・状態管理の基本思想）
     - Documentation Policy（ドキュメントの一貫性、AIが作るドキュメントの扱い方の方針）
     - Development Mindset（過度な複雑化を避ける、名前は読みやすく役割が明確、機能追加時の基本スタンス）
   - **テンプレート形式に従う**: 下記の「AGENTS.mdテンプレート」セクションの構造を必ず遵守してください
   - **思想のみを記述**: 各セクションは「なぜ」という価値観・思想のみを記述し、「どう」という具体的な手順は含めない
   - **簡潔に記述**: 各セクションは要点を絞り、1項目あたり1〜3行程度に収める
   - **箇条書きを優先**: 長文の説明は避け、箇条書きで要点を明確に
   - **判断基準は1行**: 判断基準は1行で簡潔に記述（例：「AIが理解しやすいか？」）
   - **重複を避ける**: 同じ内容を複数のセクションで繰り返さない
   - **全体で50行以内を目安**: AGENTS.md全体が50行程度になるよう調整（Project Visionを含む）
   - Project Visionから導かれる思想を優先的に反映
   - Project Visionと整合性が取れるように調整

6. **プレビューを表示**
   - 生成したAGENTS.mdの全体をプレビューとして表示
   - **テンプレート構造の確認（最重要）**: 以下の5つのセクション名が正しく使用されているか確認
     - [ ] `# Project Vision` が含まれている
     - [ ] `# Core Principles` が含まれている
     - [ ] `# Architecture Philosophy` が含まれている
     - [ ] `# Documentation Policy` が含まれている
     - [ ] `# Development Mindset` が含まれている
     - [ ] テンプレートにないセクション（Agent Roles、Agent Interaction Rules、Development Workflow、Quality Standardsなど）が含まれていない
   - **具体的なルールが含まれていないか確認（最重要）**: 以下のような具体的なルールが含まれていないか確認
     - [ ] 命名規則（camelCase、PascalCase、snake_caseなど）
     - [ ] ツール名（black、isort、WebDriverWaitなど）
     - [ ] 設定値（10-20秒、UTF-8、`chcp 65001`など）
     - [ ] ファイル名・フォルダ構造（`config.bat`、`stamp.py`、`src/features/**`など）
     - [ ] 実装方法（「ID > CSS Selector > XPathの優先順位」など）
     - [ ] コード例・コードスニペット
     - [ ] その他、「どうするのか」という具体的な手順・形式
   - **行数を確認**: 全体が50行以内になっているか確認し、超過している場合は簡潔化を提案
   - **思想のみか確認**: 上記の具体的なルールが含まれている場合は、思想のみに修正
   - 「以下の内容でAGENTS.mdを作成します。全体で[行数]行です。テンプレート構造に従っています。具体的なルールは含まれていません。修正があれば教えてください。」と確認を求める

7. **テンプレート準拠検証（必須）**
   - **⚠️ 重要: プレビュー表示後、必ず以下のチェック項目を実行してください**
   - **テンプレート構造の確認（最重要・最初に実行）**: 
     - [ ] `# Project Vision` という見出しが含まれている（正確なセクション名）
     - [ ] `# Core Principles` という見出しが含まれている（正確なセクション名）
     - [ ] `# Architecture Philosophy` という見出しが含まれている（正確なセクション名）
     - [ ] `# Documentation Policy` という見出しが含まれている（正確なセクション名）
     - [ ] `# Development Mindset` という見出しが含まれている（正確なセクション名）
     - [ ] 上記5セクション以外のセクション（Agent Roles、Agent Interaction Rules、Development Workflow、Quality Standards、Technical Stack、Constraintsなど）が含まれていない
     - [ ] セクション名が変更されていない（例：`# Core Principle`（単数形）ではなく`# Core Principles`（複数形））
   - **テンプレート項目の内容確認**: 各セクションに適切な内容が含まれているか確認
     - [ ] Project Vision（ユーザーの回答）
     - [ ] Core Principles（優先順位、ユーザー体験の基本方針、設計上の思想）
     - [ ] Architecture Philosophy（ディレクトリ構成の思想、責務分離の方針、データ・状態管理の基本思想）
     - [ ] Documentation Policy（ドキュメントの一貫性、AIが作るドキュメントの扱い方の方針）
     - [ ] Development Mindset（過度な複雑化を避ける、名前は読みやすく役割が明確、機能追加時の基本スタンス）
   - **テンプレート形式の確認**: 各セクションの見出し形式（`# セクション名`）が正しいか確認
   - **箇条書き形式の確認**: 各セクションの項目が箇条書き（`- `）形式になっているか確認
   - **思想のみか確認（最重要）**: 各セクションに以下のような具体的なルールが含まれていないか確認
     - [ ] 命名規則（camelCase、PascalCase、snake_case、UPPER_SNAKE_CASEなど）
     - [ ] ツール名・ライブラリ名（black、isort、WebDriverWait、Selenium、ChromeDriverなど）
     - [ ] 設定値・数値（10-20秒、UTF-8、`chcp 65001`、3.6以上など）
     - [ ] ファイル名・フォルダ構造（`config.bat`、`stamp.py`、`worklog.py`、`src/features/**`、`modules/`など）
     - [ ] 実装方法・手順（「ID > CSS Selector > XPathの優先順位」「要素の待機処理」「エラーハンドリングは呼び出し側で実装」など）
     - [ ] コード例・コードスニペット（`const x = 10;`、`if %errorlevel%`など）
     - [ ] コマンド・コマンドライン（`chcp 65001`、`git add`など）
     - [ ] その他、「どうするのか」という具体的な手順・形式・実装方法
   - **行数の確認**: 全体が50行以内になっているか確認
   - **検証結果の表示**: チェック項目を全て確認し、問題があれば修正を提案
   - 「テンプレート準拠チェック: [OK/NG]。NGの場合は修正します。」と表示
   - **NGの場合**: テンプレート構造に従っていない場合は、必ずテンプレート構造に合わせて修正し、再度検証を実行

8. **テンプレート準拠の修正（必要に応じて）**
   - 検証で問題が見つかった場合、テンプレート形式に合わせて修正
   - **特に重要な修正1: テンプレート構造**: テンプレートにないセクションが含まれている場合は、必ず削除し、テンプレートの5セクションのみに修正
   - **特に重要な修正2: 具体的なルールの削除**: 具体的なルール（命名規則、ツール名、設定値、ファイル名、実装方法など）が含まれている場合は、必ず削除し、思想・価値観のみに修正
     - 例：「PEP8準拠（black/isort推奨）」→「コードスタイルの一貫性を保つことで、チーム全体の生産性を向上させる」
     - 例：「WebDriverWaitを使用した明示的な待機処理」→「適切な待機処理により、ブラウザ自動化の安定性を確保する」
     - 例：「認証情報は`config.bat`に保存（.gitignoreに追加）」→「認証情報の安全な管理を最優先する」
   - **セクション名の修正**: セクション名が間違っている場合は、テンプレートで定義された正確なセクション名に修正
   - 修正後、再度テンプレート準拠検証（手順7）を実行
   - 全てのチェック項目がOKになるまで繰り返す

9. **ユーザーの確認と修正**
   - ユーザーから修正指示があれば反映
   - 修正後の内容を再度確認
   - **修正後もテンプレート構造を維持**: ユーザーの修正指示があっても、テンプレートの5セクション構造は維持する
   - 確認が取れるまで繰り返す

10. **確認が取れたらAGENTS.mdを保存**
   - プロジェクトルートにAGENTS.mdとして保存
   - **保存前に再度テンプレート準拠を確認**: 手順7のチェック項目を最終確認
   - **特に確認**: テンプレートの5セクションのみが含まれていることを最終確認

11. **完了確認メッセージを表示し、ユーザーの確認を待つ（必須）**
   - **⚠️ 重要**: このステップを必ず実行してください。スキップして次のステップに進まないでください
   - 以下のメッセージを表示:
     ```
     ✅ ステップ2: AGENTS.mdの作成が完了しました。
     
     作成されたファイル:
     - AGENTS.md
     
     テンプレート準拠確認:
     - 5セクション全て含まれている: OK
     - テンプレート形式に従っている: OK
     - 思想のみを記述（具体的なルールなし）: OK
       - 命名規則、ツール名、設定値、ファイル名、実装方法などの具体的なルールは含まれていない
     - 全体50行以内: OK
     
     次のステップ（.cursor/rules/の作成）に進みますか？
     - yes: ステップ3を開始します
     - no: ここで終了します
     ```
   - **必ずユーザーの回答を待ってください**（自動で次のステップに進まない）
   - ユーザーが「yes」と回答するまで、ステップ3に進まないでください

### AGENTS.mdテンプレート

```markdown
# Project Vision
- [ユーザーの回答を記述。1〜3行程度]

# Core Principles
- 優先順位（例：読みやすさ > パフォーマンス）: [AIがProject Visionから導かれる価値観を1行で記述。具体的なルールは記載しない]
- ユーザー体験の基本方針: [AIがProject Visionから導かれる「なぜその体験が重要なのか」という思想を1〜2行で記述]
- 設計上の思想: [AIがProject Visionから導かれる「なぜその設計が重要なのか」という価値観を1〜2行で記述]

# Architecture Philosophy
- ディレクトリ構成の思想: [AIがProject Visionから導かれる「なぜその構造が重要なのか」という価値観を1行で記述。具体的な構造（例：src/features/**）は記載しない]
- 責務分離の方針: [AIがProject Visionから導かれる「なぜ責務分離が重要なのか」という思想を1行で記述]
- データ・状態管理の基本思想: [AIがProject Visionから導かれる「なぜその管理方法が重要なのか」という価値観を1行で記述]

# Documentation Policy
- ドキュメントの一貫性をどう保つか: [AIがProject Visionから導かれる「なぜ一貫性が重要なのか」という思想を1行で記述。具体的な記法（例：Markdownの見出し階層）は記載しない]
- AI が作るドキュメントの扱い方の方針: [AIがProject Visionから導かれる「なぜその扱い方が重要なのか」という価値観を1行で記述。具体的なパスは記載しない]

# Development Mindset
- 過度な複雑化を避ける: [AIがProject Visionから導かれる「なぜシンプルさが重要なのか」という思想を1行で記述]
- 名前は読みやすく、役割が明確に伝わるもの: [AIがProject Visionから導かれる「なぜ可読性が重要なのか」という価値観を1行で記述。具体的な命名規則（例：camelCase）は記載しない]
- 機能追加時の基本スタンス: [AIがProject Visionから導かれる「なぜそのスタンスが重要なのか」という思想を1行で記述]
```

**⚠️ 最重要1: テンプレート構造の厳格な遵守**
- **使用するセクション名は5つのみ**: 上記の5セクション（`# Project Vision`、`# Core Principles`、`# Architecture Philosophy`、`# Documentation Policy`、`# Development Mindset`）のみを使用する
- **テンプレートにないセクションは追加しない**: Agent Roles、Agent Interaction Rules、Development Workflow、Quality Standards、Technical Stack、Constraintsなどのセクションは一切追加しない
- **セクション名の変更は禁止**: テンプレートで定義されたセクション名を変更したり、別名で呼んだりしない（例：`# Core Principle`（単数形）ではなく`# Core Principles`（複数形））
- **プロジェクトの要件に応じたセクション追加は禁止**: プロジェクトが複雑でも、テンプレートの5セクションのみを使用し、思想のみを簡潔に記述する

**⚠️ 最重要2: 具体的なルールを記載しない（思想・価値観のみ）**
- **記載してはいけない具体例**:
  - ❌ 命名規則（camelCase、PascalCase、snake_case、UPPER_SNAKE_CASEなど）
  - ❌ ツール名・ライブラリ名（black、isort、WebDriverWait、Selenium、ChromeDriverなど）
  - ❌ 設定値・数値（10-20秒、UTF-8、`chcp 65001`、3.6以上など）
  - ❌ ファイル名・フォルダ構造（`config.bat`、`stamp.py`、`worklog.py`、`src/features/**`、`modules/`など）
  - ❌ 実装方法・手順（「ID > CSS Selector > XPathの優先順位」「要素の待機処理」「エラーハンドリングは呼び出し側で実装」など）
  - ❌ コード例・コードスニペット（`const x = 10;`、`if %errorlevel%`など）
  - ❌ コマンド・コマンドライン（`chcp 65001`、`git add`など）
- **記載すべき内容**: 「なぜそうするのか」という思想・価値観のみ
  - ✅ 例：「コードの可読性を最優先し、一貫性を重視する」
  - ✅ 例：「適切な待機処理により、ブラウザ自動化の安定性を確保する」
  - ✅ 例：「認証情報の安全な管理を最優先する」

**その他の重要事項**: 
- テンプレート項目を必ず含める（5セクション: Project Vision、Core Principles、Architecture Philosophy、Documentation Policy、Development Mindset）
- 思想のみを記述（「なぜ」のみ、「どう」は記載しない）
- 全体で50行以内を目安
- 詳細は「生成方針（手順5）」を参照

---

## ステップ3: .cursor/rules/の作成

### サマリ提案の作成

**重要**: AGENTS.mdの内容と、@rulesを参照して、必要なルールファイルを提案してください。

#### 提案の観点

**プロジェクトタイプに応じて、以下の観点から必要なルールを判断してください：**

1. **コード規約系**（コーディングプロジェクトの場合）
   - 使用言語に応じたコーディング規約（C#, Python, JavaScript, Unity C#, GAS など）
   - 命名規則
   - フォーマット規則

2. **文書作成規約系**（文書作成プロジェクトの場合）
   - Markdown記法ルール
   - 文書構造ルール（見出し階層、セクション構成など）
   - スタイルガイド（表記統一、用語集など）
   - 引用・参考文献のルール
   - 画像・図表の扱い方
   - 翻訳・多言語対応の方針

3. **プロジェクト構造系**
   - フォルダ構成ルール
   - ファイル命名規則
   - 1機能のフォルダ構成・クラス構成ルール（コーディングプロジェクトの場合）
   - 文書の分類・整理ルール（文書作成プロジェクトの場合）

4. **開発プロセス系**
   - Gitコミットメッセージルール
   - ドキュメント作成ルール（Markdown記法など）
   - テスト方針（コーディングプロジェクトの場合）
   - レビュープロセス（文書作成プロジェクトの場合）

5. **品質管理系**
   - AI応答ガバナンス（提案の正確性、ファクトチェック）
   - エラーハンドリング方針（コーディングプロジェクトの場合）
   - ログ出力方針（コーディングプロジェクトの場合）
   - 文書品質チェック方針（文書作成プロジェクトの場合）

### 提案フォーマット

**プロジェクトタイプに応じて、適切なカテゴリのルールを提案してください。**

以下の形式でサマリを表示します：

```
📋 .cursor/rules/に作成するルールファイルの提案

【カテゴリ名】（例：コード規約系、文書作成規約系、プロジェクト構造系など）
1. [ファイル名].mdc
   - 内容: [ルールの概要]
   - 適用範囲: [globパターン]
   - 理由: AGENTS.mdの「[セクション名]」を実現するため

2. [ファイル名].mdc
   - 内容: [ルールの概要]
   - 適用範囲: [globパターン]
   - 理由: [理由を記載]

---
合計: [N]個のルールファイルを作成予定

この提案で進めますか？ (yes/no)
- yes: 提案通りに作成します
- no: 修正や追加の希望を教えてください
```

**重要**: Project Visionの内容を分析し、プロジェクトタイプ（コーディング/文書作成/その他）に応じて適切なカテゴリのルールを提案してください。混在するプロジェクトの場合は、両方のカテゴリを含めて提案してください。

### ユーザーとの合意プロセス

**⚠️ 重要: このステップでは必ずサマリを提案し、ユーザーの合意を得てからファイルを作成してください。**

1. **ステップ開始の明示**
   - 「ステップ3: .cursor/rules/の作成を開始します。まず、作成するルールファイルのサマリを提案します。」と明示

2. **サマリを表示**
   - 上記のフォーマットで提案を表示
   - **必ずユーザーの確認を待ってください**（自動でファイルを作成しない）

3. **ユーザーの確認を待つ**
   - 「この提案で進めますか？ (yes/no)」と確認
   - **ユーザーが「yes」と回答するまで、ファイルを作成しないでください**

4. **修正要望があれば反映して再提案**
   - ユーザーが「no」または修正要望を出した場合、内容を修正して再提案
   - 再度確認を求める

5. **合意が取れたらファイル作成へ**
   - 「yes」または合意が取れたら、実際のファイル作成に進む

### ルールファイルの作成

合意が取れたら、各ルールファイルを以下の手順で作成します：

1. **@rulesを参照**
   - 既存の@rulesから該当するルールを参照
   - AGENTS.mdの内容と整合性を確認
   - **@rulesに記載されている内容をそのまま使用してください**

2. **.mdcファイルの形式で作成**
   - 各ファイルは以下のメタ情報を含む：
     ```markdown
     ---
     description: [ルールの説明。AGENTS.mdのどの原則に基づいているかも記載]
     globs:
       - "[適用範囲のglobパターン]"
     alwaysApply: [true/false]
     ---
     
     [ルールの内容]
     ```

3. **ファイル名の命名規則**
   - `kebab-case.mdc` 形式
   - 内容が明確に分かる名前（例: `coding-conventions-csharp.mdc`）

4. **各ファイルの内容**
   - @rulesから該当セクションを抽出
   - AGENTS.mdの原則と整合性を保つ
   - 具体的で実行可能なルールとして記述
   - **@rulesの内容をそのまま転記してください**

### 作成例

各.mdcファイルは以下の形式で作成します：

```markdown
---
description: [ルールの説明。AGENTS.mdのどの原則に基づいているかも記載]
globs:
  - "[適用範囲のglobパターン]"
alwaysApply: [true/false]
---

# [ルール名]

[@rulesの該当ルール内容をそのまま転記]
```

### 完了確認

全てのルールファイルの作成が完了したら、以下のメッセージを表示します：

```
✅ ステップ3: .cursor/rules/の作成が完了しました。

作成されたルールファイル:
- [ファイル名1]
- [ファイル名2]
- ...

🎉 初期セットアップが完了しました！

これで、Cursorを使った安定した開発を開始できます。
```

---

## 使用方法

このワークフローを実行するには、以下のように呼び出します：

```
@project-rule-setup を実行してください
```

または

```
プロジェクトの初期セットアップを開始してください
```

**重要**: 各ステップの完了時に必ずユーザーの確認を求めてください。詳細は「実行時の注意事項」を参照。

---

## エラーハンドリング

- **既存ファイル**: 上書きせずに確認を求める
- **既存フォルダ**: 既存構造を保持し、不足分のみ追加
- **中断時**: 完了したステップまでを保存し、再開時に前回の状態を確認

---

## 実行時の注意事項

1. **段階的な確認（最重要）**: 
   - 各ステップの完了時に必ずユーザーの確認を求める
   - ステップ2完了時: 手順11の完了確認メッセージを必ず表示
   - ユーザーの確認なしに次のステップに進まない

2. **テンプレート確認の必須化（最重要）**: 
   - ステップ2の開始時: 必ず最初にテンプレートを確認・表示する
   - テンプレート形式に厳密に従うことを強調する
   - **テンプレート構造の厳格な遵守**: 5セクションのみを使用し、テンプレートにないセクションは追加しない
   - **セクション名の正確性**: テンプレートで定義された正確なセクション名を使用する
   - テンプレート準拠検証（手順7）を必ず実行する

3. **@rulesの参照**: 
   - ステップ2: 思想のみを抽出（具体的なルールは参照しない）
     - 命名規則、ツール名、設定値、ファイル名、実装方法などの具体的なルールは参照しない
     - ルールの「背後にある思想・価値観」のみを抽出する
   - ステップ3: @rulesの内容をそのまま使用

4. **AGENTS.mdの整合性**: 
   - ステップ3では、AGENTS.mdの原則に基づいてルールを判断

5. **テンプレートの遵守**: 
   - AGENTS.md: 5セクション必須、思想のみ、50行以内、テンプレート形式厳守
   - **具体的なルールを記載しない**: 命名規則、ツール名、設定値、ファイル名、実装方法などの具体的なルールは記載しない
   - テンプレート準拠検証（手順7）で全てのチェック項目を確認（テンプレート構造、具体的なルールの有無を含む）
   - .mdcファイル: メタ情報（description, globs, alwaysApply）必須
